elasticsearch:
  dedicated: true
  imagePullSecrets:
  - name: private-registry-mil

istio:
  enabled: true

imagePullSecrets:
- name: private-registry-mil

violations:
  allowedUsers:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  bannedImageTags:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  allowedDockerRegistries:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  restrictedTaint:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  pspCapabilities:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  httpsOnly:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  allowedIPs:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  allowedHostFilesystem:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  allowedFlexVolumes:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  allowedAppArmorProfiles:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  allowedProcMount:
    enabled: false
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  hostNetworking:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  allowedSecCompProfiles:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  readOnlyRoot:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  selinuxPolicy:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  containerRatio:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  noBigContainers:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  noPrivilegedEscalation:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  noPrivilegedContainers:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  uniqueIngressHost:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  noHostNamespace:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  blockNodePort:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  imageDigest:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  uniqueServiceSelector:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  requiredLabels:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  volumeTypes:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  noSysctls:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  requiredProbes:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  podsHaveIstio:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]
  namespacesHaveIstio:
    enforcementAction: deny
    match:
      excludedNamespaces: ["cluster-auditor","gatekeeper-system","eckoperator","istio-system","kube-system"]

bbtests:
  enabled: true
  scripts:
    image: registry1.dso.mil/ironbank/opensource/kubernetes-1.20/kubectl-1.20:v1.20.6
    additionalVolumeMounts:
      - name: "{{ .Chart.Name }}-test-config"
        mountPath: /yaml
      - name: "{{ .Chart.Name }}-kube-cache"
        mountPath: /.kube/cache
    additionalVolumes:
      - name: "{{ .Chart.Name }}-test-config"
        configMap:
          name: "{{ .Chart.Name }}-test-config"
      - name: "{{ .Chart.Name }}-kube-cache"
        emptyDir: {}
